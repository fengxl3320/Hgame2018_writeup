# week2 - misc (1, 2)

## 咻咻咻

这里有两个知识点，压缩包伪加密和音频 LSB 隐写。

先放一些参考资料：
> [V爷爷整理的关于压缩包的知识点](http://veritas501.space/2017/06/23/%E7%BB%99%E4%BD%A0%E5%8E%8B%E7%BC%A9%E5%8C%85%E5%8D%B4%E4%B8%8D%E7%BB%99%E4%BD%A0%E5%AF%86%E7%A0%81%E7%9A%84%E4%BA%BA%E5%88%B0%E5%BA%95%E5%9C%A8%E6%83%B3%E4%BB%80%E4%B9%88/)
> [zip文件格式](https://pkware.cachefly.net/webdocs/APPNOTE/APPNOTE-6.2.0.txt)
> [音频 LSB 隐写](https://ethackal.github.io/2015/10/05/derbycon-ctf-wav-steganography/)

zip 伪加密就是在文件头的加密标志位做修改，进而打开文件时被识别为加密压缩包。所以把相应的标志位改回 0 就好了，另外在 Mac OS 及部分 Linux 系统中可以直接打开伪加密的压缩包。

除了图片，还可以把音频，视频等作为隐写载体，但是原理基本相近。简单了解一下 wav 文件的格式：

```
文件头  
  
偏移地址    字节数 类型  内容   
  
00H~03H     4   字符  资源交换文件标志（RIFF）  
04H~07H     4   长整数 从下个地址开始到文件尾的总字节数  
08H~0BH     4   字符  WAV文件标志（WAVE）  
0CH~0FH     4   字符  波形格式标志（FMT）  
10H~13H     4   整数  过滤字节（一般为00000010H）  
14H~15H     2   整数  格式种类（值为1时，表示数据为线性PCM编码）  
16H~17H     2   整数  通道数，单声道为1，双声音为2  
18H~1BH     4   长整数 采样频率  
1CH~1FH     4   长整数 波形数据传输速率（每秒平均字节数）  
20H~21H     2   整数  数据的调整数（按字节计算）  
22H~23H     2   整数  样本数据位数  
  
数据块  
偏移地址    字节数 类型  内容   
24H~27H     4   字符  数据标志符（data）  
28H~2BH     4   长整型 采样数据总数  
2CH...      ... 数据  采样数据  
```

隐写的过程还是挺复杂的，不过github上有写好的[提取脚本](https://github.com/ragibson/Steganography)，很多人应该尝试过 `SilentEye` 这个软件，看了一下源码发现它在做隐写时还加了一层其他的加密，所以没用它出题XD。

## White cosmos

“隐形的字”一般都是用其他不易被直接观察到的东西来做替换，而文本中不能被直接看到的就是空格与 tab 了。

可以看到文件只有两种字符： 0x09 与 0x20 ，分别代表 tab 与空格，因此直接看看不到任何字。稍微脑洞一下把它们替换成 1 与 0 ，再转化为字符串即可。

EXP：

``` python
# !/usr/bin/python 
# coding=utf-8 

s='09092009 20202020 09092020 09090920 09092020 20200920 09092009 09200920 09092020 09200920 09090909 20090920 09200920 09090920 09092020 09200920 09092009 09202020 09092020 20090920 20090920 20202020 09092009 09200920 09092020 09200920 09200909 09090920 20090920 20092020 09200909 09090920 09200920 09090920 09092009 20202020 09202009 20200920 09090920 09202020 09092020 09200920 09200909 09090920 09090920 20090920 09090920 20202020 20090920 09202020 09092020 20090920 09092020 09200920 09090909 092009'

temp = ((s.replace('09','1')).replace('20', '0')).split()
temp = "".join(temp)

print hex(int(temp,2))
```




